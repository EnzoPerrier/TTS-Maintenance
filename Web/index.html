<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <title>Maintenance Suite</title>
  <link rel="stylesheet" href="style.css" />
  <!-- Leaflet CSS pour la carte -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
  <style>
    /* Style spÃ©cifique pour la liste des sites */
    #sitesList li {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 1.25rem;
      margin-bottom: 0.75rem;
      background: var(--white);
      border: 1px solid var(--gray-200);
      border-radius: var(--radius-md);
      transition: var(--transition);
    }

    #sitesList li:hover {
      border-color: var(--primary-blue);
      box-shadow: var(--shadow-sm);
      transform: translateX(4px);
    }

    #sitesList li > div:first-child {
      flex: 1;
    }

    #sitesList li strong {
      font-size: 1.1rem;
      color: var(--gray-800);
    }

    #sitesList li small {
      display: block;
      margin-top: 0.25rem;
    }
  </style>
</head>
<body>

<header>
  <div class="header-top">
    <h1>Maintenance App</h1>
    <img src="./Ressources/logoTTS.svg" class="logo"/>
  </div>
  <nav>
    <button onclick="showSection('carte')">Carte</button>
    <button onclick="showSection('clients')">Clients</button>
    <button onclick="showSection('sites')">Sites</button>
    <button onclick="showSection('produits')">Produits</button>
    <button onclick="showSection('maintenances')">Maintenances</button>
  </nav>
</header>

<main>
  <!-- CARTE -->
  <section id="carte" class="active">
    <h2>ğŸ—ºï¸ Carte des sites</h2>
    <div id="allSitesMapContainer" style="width: 100%; height: 600px; margin-top: 1.5rem; border-radius: 8px; overflow: hidden; border: 2px solid #DEE2E6;">
      <div id="allSitesMap" style="width: 100%; height: 100%;"></div>
    </div>
  </section>

  <!-- CLIENTS -->
  <section id="clients">
    <h2>ğŸ‘¥ Clients</h2>

    <!-- Barre de recherche -->
    <input type="text" id="searchClients" placeholder="Rechercher un client..." />

    <ul id="clientsList"></ul>

    <!-- Bouton flottant pour ajouter un client -->
    <button title="Ajouter un nouveau client" id="addClientBtn" class="fab" onclick="showAddClientForm()">+</button>

    <!-- Formulaire masquÃ© par dÃ©faut -->
    <div id="addClientForm" class="modal">
      <form onsubmit="addClient(event)">
        <h3 id="clientFormTitle">Ajouter un client</h3>
        <input type="text" id="clientNom" placeholder="Nom du client" required />
        <input type="text" id="clientContact" placeholder="Contact" required />
        <input type="text" id="clientAdresse" placeholder="Adresse" />
        <input type="email" id="clientEmail" placeholder="Email" />
        <input type="tel" id="clientTelephone" placeholder="TÃ©lÃ©phone" />
        <button class="primary" type="submit" id="clientSubmitBtn">Ajouter</button>
        <button type="button" onclick="hideAddClientForm()">Annuler</button>
      </form>
    </div>
  </section>

  <!-- SITES -->
  <section id="sites">
    <h2>ğŸ¢ Sites</h2>

    <!-- Barre de recherche -->
    <input type="text" id="searchSites" placeholder="Rechercher par nom ou ville..." />

    <ul id="sitesList"></ul>

    <!-- Bouton flottant pour ajouter un site -->
    <button title="Ajouter un nouveau site" id="addSiteBtn" class="fab" onclick="showAddSiteForm()">+</button>

    <!-- Formulaire masquÃ© par dÃ©faut -->
    <div id="addSiteForm" class="modal">
      <form onsubmit="addSite(event)">
        <h3 id="siteFormTitle">Ajouter un site</h3>
        <select id="siteClientId" required>
          <option value="">-- SÃ©lectionner un client --</option>
        </select>
        <input type="text" id="siteNom" placeholder="Nom du site" required />
        <input type="text" id="siteAdresse" placeholder="Adresse" required />
        <input type="number" step="0.000001" id="siteLat" placeholder="Latitude" />
        <input type="number" step="0.000001" id="siteLng" placeholder="Longitude" />
        <button class="primary" type="submit" id="siteSubmitBtn">Ajouter</button>
        <button type="button" onclick="hideAddSiteForm()">Annuler</button>
      </form>
    </div>
  </section>

<!-- PRODUITS -->
<section id="produits">
  <h2>ğŸ“¦ Produits</h2>

  <!-- Barre de recherche -->
  <input type="text" id="searchProduits" placeholder="Rechercher un produit..." />

  <!-- Liste des produits -->
  <ul id="produitsList"></ul>

  <!-- Bouton flottant pour ajouter un produit -->
  <button title="Ajouter un nouveau produit" id="addProductBtn" class="fab" onclick="showAddProduitForm()">+</button>

  <!-- Formulaire masquÃ© par dÃ©faut -->
  <div id="addProduitForm" class="modal" style="display:none">
    <form id="produitForm" onsubmit="addProduit(event)">
      <h3>Ajouter un produit</h3>
      <input type="text" id="produitNom" placeholder="Nom du produit" required />
      
      <!-- Recherche de site avec autocomplÃ©tion -->
      <div style="position: relative;">
        <input 
          type="text" 
          id="produitSiteSearch" 
          placeholder="Rechercher un site par nom..." 
          autocomplete="off"
          required
        />
        <input type="hidden" id="produitSiteId" required />
        <div id="siteSearchResults" style="
          display: none;
          position: absolute;
          top: 100%;
          left: 0;
          right: 0;
          background: white;
          border: 2px solid var(--primary-blue);
          border-top: none;
          border-radius: 0 0 8px 8px;
          max-height: 200px;
          overflow-y: auto;
          z-index: 1000;
          box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        "></div>
      </div>
      
      <input type="text" id="produitDepartement" placeholder="Departement" />
      <select id="produitEtat">
        <option value="">-- Ã‰tat --</option>
        <option value="OK">OK</option>
        <option value="NOK">NOK</option>
        <option value="Passable">Passable</option>
      </select>
      <textarea id="produitDescription" placeholder="Description"></textarea>
      <button class="primary" type="submit">Ajouter</button>
      <button type="button" onclick="hideAddProduitForm()">Annuler</button>
    </form>
  </div>
</section>

  <!-- MAINTENANCES -->
  <section id="maintenances">
    <h2>ğŸ”§ Maintenances</h2>
    <ul id="maintenancesList"></ul>
  </section>
</main>

<footer style="
  background: var(--gray-800, #2D3748);
  color: var(--white, #FFFFFF);
  text-align: center;
  padding: 1.5rem;
  margin-top: 3rem;
  border-top: 3px solid var(--primary-blue, #3B82F6);
">
  <a href="https://github.com/EnzoPerrier" 
     target="_blank" 
     rel="noopener noreferrer"
     style="
       color: var(--white, #FFFFFF);
       text-decoration: none;
       font-size: 0.95rem;
       transition: color 0.3s ease;
       display: inline-block;
     "
     onmouseover="this.style.color='var(--primary-blue, #3B82F6)'"
     onmouseout="this.style.color='var(--white, #FFFFFF)'">
    Â© 2026 Enzo Perrier - Tous droits rÃ©servÃ©s
  </a>
</footer>

<!-- Leaflet JS pour la carte -->
<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
<script src="script.js" defer></script>
</body>
</html>