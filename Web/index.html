<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <title>Maintenance Suite</title>
  <link rel="stylesheet" href="style.css" />
  <!-- Leaflet CSS pour la carte -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
</head>
<body>

<header>
  <div class="header-top">
    <h1>Maintenance App</h1>
    <img src="./Ressources/logoTTS.svg" class="logo"/>
  </div>
  <nav>
    <button onclick="showSection('carte')">Carte</button>
    <button onclick="showSection('clients')">Clients</button>
    <button onclick="showSection('sites')">Sites</button>
    <button onclick="showSection('produits')">Produits</button>
    <button onclick="showSection('maintenances')">Maintenances</button>
  </nav>
</header>

<main>
  <!-- CARTE -->
  <section id="carte" class="active">
    <h2>ğŸ—ºï¸ Carte des sites</h2>
    <div id="allSitesMapContainer" style="width: 100%; height: 600px; margin-top: 1.5rem; border-radius: 8px; overflow: hidden; border: 2px solid #DEE2E6;">
      <div id="allSitesMap" style="width: 100%; height: 100%;"></div>
    </div>
  </section>

  <!-- CLIENTS -->
  <section id="clients">
    <h2>ğŸ‘¥ Clients</h2>

    <!-- Barre de recherche (rÃ©utilise le style de searchSites) -->
    <input type="text" id="searchClients" placeholder="Rechercher par nom, contact, email ou tÃ©lÃ©phone..." style="width: 100%; padding: 0.875rem 1.25rem; border: 2px solid var(--gray-200); border-radius: var(--radius-md); font-size: 1rem; margin-bottom: 1.5rem; transition: var(--transition); background: var(--gray-50);" />

    <ul id="clientsList"></ul>

    <!-- Bouton flottant pour ajouter un client (mÃªme style que addSiteBtn) -->
    <button title="Ajouter un nouveau client" id="addClientBtn" class="fab" onclick="showAddClientForm()">+</button>

    <!-- Formulaire masquÃ© par dÃ©faut (rÃ©utilise le style de addSiteForm) -->
    <div id="addClientForm" class="modal">
      <form onsubmit="addClient(event)">
        <h3>Ajouter un client</h3>
        <input type="text" id="clientNom" placeholder="Nom du client *" required />
        <input type="text" id="clientContact" placeholder="Nom du contact" />
        <input type="email" id="clientEmail" placeholder="Email" />
        <input type="tel" id="clientTelephone" placeholder="TÃ©lÃ©phone" />
        <textarea id="clientAdresse" placeholder="Adresse"></textarea>
        <button class="primary">Ajouter</button>
        <button type="button" onclick="hideAddClientForm()">Annuler</button>
      </form>
    </div>
  </section>

  <!-- SITES -->
  <section id="sites">
    <h2>Sites</h2>

    <!-- Barre de recherche -->
    <input type="text" id="searchSites" placeholder="Rechercher par nom ou ville..." />

    <ul id="sitesList"></ul>

    <!-- Bouton flottant pour ajouter un site -->
    <button title="Ajouter un nouveau site" id="addSiteBtn" class="fab" onclick="showAddSiteForm()">+</button>

    <!-- Formulaire masquÃ© par dÃ©faut -->
    <div id="addSiteForm" class="modal">
      <form onsubmit="addSite(event)">
        <h3>Ajouter un site</h3>
        
        <!-- Recherche de client -->
        <input type="text" id="clientSearch" placeholder="Rechercher un client par nom ou contact..." autocomplete="off" />
        <select id="siteClientId" required style="margin-top: 0.5rem;">
          <option value="">-- SÃ©lectionner un client --</option>
        </select>
        
        <input type="text" id="siteNom" placeholder="Nom du site" required />
        <input type="text" id="siteAdresse" placeholder="Adresse" required />
        <input type="number" step="0.000001" id="siteLat" placeholder="Latitude" />
        <input type="number" step="0.000001" id="siteLng" placeholder="Longitude" />
        <button class="primary">Ajouter</button>
        <button type="button" onclick="hideAddSiteForm()">Annuler</button>
      </form>
    </div>
  </section>

  <!-- PRODUITS -->
  <section id="produits">
    <h2>Produits</h2>

    <!-- Barre de recherche -->
    <input type="text" id="searchProduits" placeholder="Rechercher un produit..." />

    <!-- Liste des produits -->
    <ul id="produitsList"></ul>

    <!-- Bouton flottant pour ajouter un produit -->
    <button title="Ajouter un nouveau produit" id="addProductBtn" class="fab" onclick="showAddProduitForm()">+</button>

    <!-- Formulaire masquÃ© par dÃ©faut -->
    <div id="addProduitForm" class="modal" style="display:none">
      <form id="produitForm" onsubmit="addProduit(event)">
        <input type="text" id="produitNom" placeholder="Nom du produit" required />
        
        <!-- Recherche de site -->
        <input type="text" id="siteSearch" placeholder="Rechercher un site par nom ou localisation..." autocomplete="off" />
        <select id="produitSiteId" required style="margin-top: 0.5rem;">
          <option value="">-- SÃ©lectionner un site --</option>
        </select>
        
        <input type="text" id="produitDepartement" placeholder="Departement" />
        <select id="produitEtat">
          <option value="">-- Ã‰tat --</option>
          <option value="OK">OK</option>
          <option value="NOK">NOK</option>
          <option value="Passable">Passable</option>
        </select>
        <textarea id="produitDescription" placeholder="Description"></textarea>
        <button class="primary" type="submit">Ajouter</button>
        <button type="button" onclick="hideAddProduitForm()">Annuler</button>
      </form>
    </div>
  </section>

  <!-- MAINTENANCES -->
  <section id="maintenances">
    <h2>Maintenances</h2>
    <ul id="maintenancesList"></ul>
  </section>
</main>

<!-- Leaflet JS pour la carte -->
<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
<script src="script.js" defer></script>
</body>
</html>