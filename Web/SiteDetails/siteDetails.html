<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>DÃ©tails du site</title>
  <link rel="stylesheet" href="../style.css" />
  
  <!-- Leaflet CSS pour la carte -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
</head>
<body>
  <button id="backBtn">Retour</button>

  <main>
    <section class="active">
      <h1>DÃ©tails du site</h1>
      <div id="siteDetails"></div>

      <!-- Statistiques du site -->
      <div id="siteStats" style="display: flex; gap: 1rem; margin: 1.5rem 0; flex-wrap: wrap;">
        <div class="stat-card">
          <strong>ğŸ“¦ Ã‰quipements</strong>
          <span id="statsEquipements">0</span>
        </div>
        <div class="stat-card stat-planifiee">
          <strong>ğŸ“… Maintenances planifiÃ©es</strong>
          <span id="statsPlanifiees">0</span>
        </div>
        <div class="stat-card stat-en-cours">
          <strong>âš™ï¸ Maintenances en cours</strong>
          <span id="statsEnCours">0</span>
        </div>
        <div class="stat-card stat-terminee">
          <strong>âœ… Maintenances terminÃ©es</strong>
          <span id="statsTerminees">0</span>
        </div>
        <div class="stat-card stat-ok">
          <strong>âœ… Ã‰quipements OK</strong>
          <span id="statsOK">0</span>
        </div>
        <div class="stat-card stat-nok">
          <strong>âŒ Ã‰quipements NOK</strong>
          <span id="statsNOK">0</span>
        </div>
      </div>

      <!-- Carte GPS -->
      <h3 class="map-title">ğŸ“ Localisation</h3>
      <div id="mapContainer">
        <div id="map"></div>
      </div>

      <details open>
        <summary>Maintenances</summary>
        <button class="primary" onclick="showAddMaintenanceForm()" style="margin: 1rem 0;">+ Ajouter une maintenance</button>
        <div id="MaintenancesList"></div>
      </details>

      <details open>
        <summary>Ã‰quipements</summary>
        <button class="primary" onclick="showAddEquipementForm()" style="margin: 1rem 0;">+ Ajouter un Ã©quipement</button>
        <div id="EquipementsList"></div>
      </details>
    </section>
  </main>

  <!-- Formulaire ajout/modification maintenance -->
  <div id="addMaintenanceForm" class="modal">
    <form id="maintenanceForm" onsubmit="addMaintenance(event)">
      <h3 id="maintenanceFormTitle">Ajouter une maintenance</h3>
      <input type="date" id="maintenanceDate" required />
      <input type="text" id="maintenanceType" placeholder="Type de maintenance" required />
      <select id="maintenanceEtat">
        <option value="">-- Ã‰tat --</option>
        <option value="TerminÃ©e">TerminÃ©e</option>
        <option value="En cours">En cours</option>
        <option value="PlanifiÃ©e">PlanifiÃ©e</option>
      </select>
      <input type="text" id="maintenanceDepartement" placeholder="DÃ©partement" />
      <textarea id="maintenanceCommentaire" placeholder="Commentaire"></textarea>
      <input type="text" id="maintenanceRI" placeholder="RI interne" />
      <button class="primary" type="submit" id="maintenanceSubmitBtn">Ajouter</button>
      <button type="button" onclick="hideAddMaintenanceForm()">Annuler</button>
    </form>
  </div>

  <!-- Formulaire ajout/modification Ã©quipement -->
  <div id="addEquipementForm" class="modal">
    <form id="equipementForm" onsubmit="addEquipement(event)">
      <h3 id="equipementFormTitle">Ajouter un Ã©quipement</h3>
      <input type="text" id="equipementNom" placeholder="Nom de l'Ã©quipement" required />
      <input type="text" id="equipementDepartement" placeholder="DÃ©partement" />
      <select id="equipementEtat">
        <option value="">-- Ã‰tat --</option>
        <option value="OK">OK</option>
        <option value="NOK">NOK</option>
        <option value="Passable">Passable</option>
      </select>
      <textarea id="equipementDescription" placeholder="Description"></textarea>
      <button class="primary" type="submit" id="equipementSubmitBtn">Ajouter</button>
      <button type="button" onclick="hideAddEquipementForm()">Annuler</button>
    </form>
  </div>

  <!-- Leaflet JS pour la carte -->
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
  <script src="siteDetails.js" defer></script>
</body>
</html>